[TOC]

# 内置函数
gcc提供了不少有用的内置函数(Built-in Functions),这些函数说明可以在gcc的网站上找到

https://gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html

https://juejin.cn/post/7167772639484706830

https://juejin.cn/post/6844903837698899981

https://blog.csdn.net/qq_38877888/article/details/114190682


gcc内置函数进行大小端转换


 — Built-in Function: uint16_t __builtin_bswap16 (uint16_t x) 
 Returns x with the order of the bytes reversed; for example, 0xaabb becomes 0xbbaa. Byte here always means exactly 8 bits.//返回x的反序字节,例如：0xaabb变成0xbbaa,下面类同。 
 — Built-in Function: uint32_t __builtin_bswap32 (uint32_t x) 
 Similar to __builtin_bswap16, except the argument and return types are 32 bit. 
 — Built-in Function: uint64_t __builtin_bswap64 (uint64_t x) 
 Similar to __builtin_bswap32, except the argument and return types are 64 bit.
 
_bswap16,_bswap32,_bswap64三个函数分别提供了16位，32位，64位数字的字节反转功能，正好可以用来实现16,32,64位数字的大小端转换。

```C
#if __BYTE_ORDER__ ==__ORDER_BIG_ENDIAN__
    //当系统为大端时，把face_code结构体中的以小端模式存储的数据转换为大端
    inline face_code* _code_reverse(face_code* code) {  
        //gcc下用内置函数转换
        for(int i=0;i<CODE_FLOAT_NUM;i++)
            code->element[i]=(float)__builtin_bswap32((unsigned __int32)code->element[i]);
        code->sum=(double)__builtin_bswap64((unsigned __int64)code->sum);
        return code;
    }
    #define FACE_CODE_CONVERT(code) _code_reverse(code)
#else//小端模式则什么也不做直接返回
#define FACE_CODE_CONVERT(code) code
```





